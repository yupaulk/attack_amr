#metaphlan_PHY_rel_species <- subset_taxa(metaphlan_PHY_rel_species, Genus != "Coprobacillaceae Family")
#metaphlan_PHY_rel_species <- subset_taxa(metaphlan_PHY_rel_species, Genus != "Catenibacterium")
metaphlan_PHY_rel_species <- subset_taxa(metaphlan_PHY_rel_species, Species != "NA")
metaphlan_PHY_rel_species %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_species %>%
comp_barplot(tax_level = "Species",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7) +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Species (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 18, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_species.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_species <- subset_taxa(metaphlan_PHY_rel_species, Species != "NA")
metaphlan_PHY_rel_species %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_species %>%
comp_barplot(tax_level = "Species",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Other") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Species (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 18, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_species.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_species <- subset_taxa(metaphlan_PHY_rel_species, Species != "NA")
metaphlan_PHY_rel_species %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_species %>%
comp_barplot(tax_level = "Species",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Other") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Species (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 18, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_species.tiff",
width = 16, height = 16, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_species <- subset_taxa(metaphlan_PHY_rel_species, Species != "NA")
metaphlan_PHY_rel_species %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_species %>%
comp_barplot(tax_level = "Species",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Other") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Species (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 8, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_species.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_species <- subset_taxa(metaphlan_PHY_rel_species, Species != "NA")
metaphlan_PHY_rel_species %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_species %>%
comp_barplot(tax_level = "Species",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Other") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Species (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 8, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_species.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_genus <- subset_taxa(metaphlan_PHY_rel_genus, Genus != "Coprobacillaceae Family")
metaphlan_PHY_rel_genus <- subset_taxa(metaphlan_PHY_rel_genus, Genus != "Catenibacterium")
metaphlan_PHY_rel_genus <- subset_taxa(metaphlan_PHY_rel_genus, Genus != "NA")
metaphlan_PHY_rel_genus %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_genus %>%
comp_barplot(tax_level = "Genus",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7) +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Genera (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 8, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_genus.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_family <- subset_taxa(metaphlan_PHY_rel_family, Family != "Coprobacillaceae")
metaphlan_PHY_rel_family <- subset_taxa(metaphlan_PHY_rel_family, Family != "NA")
metaphlan_PHY_rel_family %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_family %>%
comp_barplot(tax_level = "Family",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7) +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Families (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 8, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_family.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_class <- subset_taxa(metaphlan_PHY_rel_class, Class != "Clostridia")
metaphlan_PHY_rel_class <- subset_taxa(metaphlan_PHY_rel_class, Class != "Erysipelotrichia")
metaphlan_PHY_rel_class <- subset_taxa(metaphlan_PHY_rel_class, Class != "NA")
metaphlan_PHY_rel_class %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_class %>%
comp_barplot(tax_level = "Class",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7) +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Classes (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 8, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_class.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_phylum <- subset_taxa(metaphlan_PHY_rel_phylum, Phylum != "NA")
metaphlan_PHY_rel_phylum %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_phylum %>%
comp_barplot(tax_level = "Phylum",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7) +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Phyla (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 8, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_phylum.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
p<-plot_bar(resfinder_PHY_rel_HWW, fill = "Class", x = "hospital")
ggsave(filename = "bar_Resfinder.tiff",
width = 16, height = 13, dpi = 300, units = "in", device='tiff', scale = 1)
otu_table_data <- otu_table(resfinder_PHY_rel_HWW)
print(head(otu_table_data))
metaphlan_PHY_rel_species <- subset_taxa(metaphlan_PHY_rel_species, Species != "NA")
metaphlan_PHY_rel_species %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_species %>%
comp_barplot(tax_level = "Species",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Others") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Species (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 12, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_species.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_genus <- subset_taxa(metaphlan_PHY_rel_genus, Genus != "Coprobacillaceae Family")
metaphlan_PHY_rel_genus <- subset_taxa(metaphlan_PHY_rel_genus, Genus != "Catenibacterium")
metaphlan_PHY_rel_genus <- subset_taxa(metaphlan_PHY_rel_genus, Genus != "NA")
metaphlan_PHY_rel_genus %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_genus %>%
comp_barplot(tax_level = "Genus",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Others") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Genera (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 12, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_genus.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_family <- subset_taxa(metaphlan_PHY_rel_family, Family != "Coprobacillaceae")
metaphlan_PHY_rel_family <- subset_taxa(metaphlan_PHY_rel_family, Family != "NA")
metaphlan_PHY_rel_family %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_family %>%
comp_barplot(tax_level = "Family",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Others") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Families (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 12, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_family.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_class <- subset_taxa(metaphlan_PHY_rel_class, Class != "Clostridia")
metaphlan_PHY_rel_class <- subset_taxa(metaphlan_PHY_rel_class, Class != "Erysipelotrichia")
metaphlan_PHY_rel_class <- subset_taxa(metaphlan_PHY_rel_class, Class != "NA")
metaphlan_PHY_rel_class %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_class %>%
comp_barplot(tax_level = "Class",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Others") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Classes (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 12, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_class.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
metaphlan_PHY_rel_phylum <- subset_taxa(metaphlan_PHY_rel_phylum, Phylum != "NA")
metaphlan_PHY_rel_phylum %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_phylum %>%
comp_barplot(tax_level = "Phylum",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Others") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Phyla (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 12, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_phylum.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
p<-plot_bar(resfinder_PHY_rel_HWW, fill = "Class", x = "hospital")
ggsave(filename = "bar_Resfinder.tiff",
width = 16, height = 13, dpi = 300, units = "in", device='tiff', scale = 1)
otu_table_data <- otu_table(resfinder_PHY_rel_HWW)
print(head(otu_table_data))
metaphlan_PHY_rel_species <- subset_taxa(metaphlan_PHY_rel_species, Species != "NA")
metaphlan_PHY_rel_species %>%
tax_fix(
min_length = 4,
unknowns = c("NA"),
sep = " ", anon_unique = TRUE,
suffix_rank = "classified"
)
p <- metaphlan_PHY_rel_species %>%
comp_barplot(tax_level = "Species",
n_taxa = 40,
bar_outline_colour = NA,
facet_by  = "hospital",
bar_width = 0.7,
other_name = "Others") +
coord_flip()  +
labs(x = NULL, y = NULL) + theme_light() + ggtitle("Top 40 Species (metaphlan)") +
theme(text = element_text(family = "Palatino"),
plot.title = element_text(size = 30, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20, color = "black", face = "bold", angle = 0, hjust = 0),
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing.y = unit(1, "lines"),
legend.text = element_text(size = 10, face = "italic"),
legend.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
legend.spacing = unit(0.25, 'cm'),
legend.key.size = unit(0.85, "cm")) + guides(fill = guide_legend(byrow = TRUE))
p
# Save plot
ggsave(filename = "plot12_species.tiff",
width = 16, height = 8, dpi = 300, units = "in", device='tiff', scale = 1)
